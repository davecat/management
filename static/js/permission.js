/**
 * Created by dave on 2017/9/20.
 */
var tree = [
  {
    "children":[],
    "id":"402880ef5e703923015e70394c2b0000",
    "name":"控制台首页",
    "permission":"instalment:home",
    "sortNum":1,
    "type":"Menu",
    "url":"home"
  },
  {
    "children":[
      {
        "id":"624dee7c11324eb6a2e4bcc26b18fadd",
        "name":"导出",
        "permission":"instalment:branch:import_button",
        "sortNum":2,
        "type":"Button"
      },
      {
        "id":"6ffd916c5511468ab744cb62b9f85f84",
        "name":"新增",
        "permission":"instalment:branch:add_button",
        "sortNum":1,
        "type":"Button"
      }
    ],
    "id":"402880ef5e703923015e70394c400001",
    "name":"门店管理",
    "permission":"instalment:branch",
    "sortNum":2,
    "type":"Menu",
    "url":"branch"
  },
  {
    "children":[
      {
        "id":"af267d9315d94c08b8440561aa62a4c3",
        "name":"导出",
        "permission":"instalment:agent:import_button",
        "sortNum":1,
        "type":"Button"
      }
    ],
    "id":"402880ef5e703923015e70394c430002",
    "name":"经纪人管理",
    "permission":"instalment:agent",
    "sortNum":3,
    "type":"Menu",
    "url":"agent"
  },
  {
    "children":[
      {
        "id":"6234524c9c204f6092e938fffd9126cd",
        "name":"导出",
        "permission":"instalment:librequest:import_button",
        "sortNum":1,
        "type":"Button"
      }
    ],
    "id":"402880ef5e703923015e70394c460003",
    "name":"分期申请",
    "permission":"instalment:request",
    "sortNum":4,
    "type":"Menu",
    "url":"request"
  },
  {
    "children":[
      {
        "id":"bad8d2306dcf43b9af5686abc46e4257",
        "name":"导出",
        "permission":"instalment:payeelib:import_button",
        "sortNum":1,
        "type":"Button"
      }
    ],
    "id":"402880ef5e703923015e70394c480004",
    "name":"对账明细",
    "permission":"instalment:statement",
    "sortNum":5,
    "type":"Menu",
    "url":"statement"
  },
  {
    "children":[
      {
        "id":"c84db7657cd6459885eea212c97b7c97",
        "name":"新增",
        "permission":"instalment:system:homeManager:add_button",
        "sortNum":1,
        "type":"Button"
      }
    ],
    "id":"402880ef5e703923015e70394c4a0005",
    "name":"房源管理",
    "permission":"instalment:homeManager",
    "sortNum":6,
    "type":"Menu",
    "url":"homeManager"
  },
  {
    "children":[
      {
        "children":[],
        "id":"402880ef5e703923015e70394c4c0006",
        "name":"日志",
        "permission":"instalment:log",
        "sortNum":7,
        "type":"Menu",
        "url":"log"
      },
      {
        "children":[
          {
            "id":"f6b2ee3ccfa441c78f63beef1400ff4b",
            "name":"新增",
            "permission":"instalment:system:agency:add_button",
            "sortNum":1,
            "type":"Button"
          }
        ],
        "id":"402880ef5e70454f015e704574dd0000",
        "name":"中介管理",
        "permission":"instalment:system:agency",
        "sortNum":1,
        "type":"Menu",
        "url":"agency"
      },
      {
        "children":[
          {
            "id":"0e676b0ee5e74df1803ddb76c689fdf2",
            "name":"新增",
            "permission":"instalment:system:user:add_button",
            "sortNum":1,
            "type":"Button"
          }
        ],
        "id":"402880ef5e70454f015e704574f00001",
        "name":"用户管理",
        "permission":"instalment:system:users",
        "sortNum":2,
        "type":"Menu",
        "url":"users"
      },
      {
        "children":[
          {
            "id":"0015a70c2c28442791127fabc68eb841",
            "name":"新增",
            "permission":"instalment:system:role:add_button",
            "sortNum":1,
            "type":"Button"
          }
        ],
        "id":"402880ef5e70454f015e704574f30002",
        "name":"角色管理",
        "permission":"instalment:system:roles",
        "sortNum":3,
        "type":"Menu",
        "url":"roles"
      }
    ],
    "id":"402880ef5e704105015e704126750000",
    "name":"系统管理",
    "permission":"instalment:system",
    "sortNum":8,
    "type":"Directory",
    "url":"system"
  }
];
let ids = ["402880ef5e704105015e704126750000","402880ef5e70454f015e704574f30002"];
let newTree = [];

function buildTree(tree, ids, newTree){
  setTimeout(function () {
    if (!tree) { return; }
    for (let i = 0; i< tree.length; i++){
      let val = tree[i];
      let finder = ids.find(id => id === val.id);
      if(finder !== undefined){
        let newVal = Object.assign({}, val);
        newVal.children = [];
        newTree.push(newVal);
        if (val.children) {
          buildTree(val.children, ids, newVal.children);
        }
      }
    }
  },1000);
}

buildTree(tree, ids, newTree);
console.log(newTree);

